<!DOCTYPE html>
<html>

<head>
    <title>References upload</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css"
          integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous"/>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design for Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.16/css/mdb.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">


    <style>


        ul,
        li {
            list-style-type: none;
        }

        .check-li {
            padding-top: calc(.375rem + 1px);
        }

        .list-type4 {
            width: 100%;
            margin: 0 auto;
        }

        .list-type4 ol {
            counter-reset: li;
            list-style: none;
            *list-style: decimal;
            font-size: 15px;
            font-family: 'Raleway', sans-serif;
            padding: 0;
            margin-bottom: 4em;
        }

        .list-type4 a {
            position: relative;
            display: block;
            padding: .4em .4em .4em 2em;
            *padding: .4em;
            margin: .5em 0;
            background: #5975D9;
            color: white;
            text-decoration: none;
            box-shadow: inset 0.5em 0 black;
            -webkit-transition: box-shadow 1s;
            transition: box-shadow 1s;
        }

        .list-type4 a:hover {
            box-shadow: inset 2em 0 black;
        }


        .sub-li {
            padding-left: 50px;
            padding-bottom: 10px;
            height: 15px;
            font-size: 8pt;
            margin-bottom: 3em !important;
            padding-top: 0 !important;
        }

        .row {
            margin-top: 10px;
        }

        .form-label {
            margin-right: 10px;
        }

        .full-label {
            height: 100% !important;
            width: 100% !important;
        }

        .error-div{
            background-color: #ff3547;
            text-align: center;
            border-radius: 8px;
            color: white;
            height: 40px;
            vertical-align: middle;
            padding: .5rem 1.6rem;
            font-size: .84rem;
        }

        .success-div{
            background-color: forestgreen;
            text-align: center;
            border-radius: 8px;
            color: white;
            height: 40px;
            vertical-align: middle;
            padding: .5rem 1.6rem;
            font-size: .84rem;
            margin-bottom: 5px;
        }

    </style>
</head>

<body>
{% include 'navbar.html' %}


<div class="col-md">
    <div class="row">
        <div class="col-4">
            <div class="card card-body">
                <h5>Upload new reference(s)</h5>
                <hr>
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="form-group row">
                        <div class="col-3">
                            <label class="form-label">BIB file: </label>
                        </div>
                        <div class="file-field col-9">
                            <div class="btn btn-info btn-sm btn-block" style="height: 85% !important;">
                                <label for="fusk" class="full-label">CHOOSE FILE</label>
                                <input id="fusk" type="file" name="document" accept=".bib" style="display: none;">
                            </div>
                        </div>
                    </div>
                    <button type="submit" , class="btn btn-outline-info btn-sm btn-block">Upload file</button>
                </form>
                <div class="form-group row">

                </div>
                {% if success_message%}
                <div class="success-div">
                    {{success_message}}
                </div>
                {%endif%}
                {% if error_message%}
                <div class="error-div">
                    {{error_message}}
                </div>
                {%endif%}
                {% if url %}
                <p>Uploaded file: <a href="{{ url }}">{{ url }}</a></p>
                {% endif %}
            </div>
        </div>

        <div class="col-8">
            <div class="card card-body">
                <h5>Total References</h5>
                <hr>
                <h1 style="text-align: center;padding: 10px">{{reference_count}}</h1>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md">
            <div class="card card-body">
                <h5>Preview and/or search references</h5>
                <hr>
                <div class="row">
                    <div class="col-3">
                        <div class="card card-body">
                            <form method="get">
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">Title:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.title}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">ISBN:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.isbn}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">ISSN:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.issn}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">DOI:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.doi}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">Rank:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.rank}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">Author:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.author}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">Team:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.team}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">Project:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.project}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">From year:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.startYear}}
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label class="form-label">To year:</label>
                                    </div>
                                    <div class="col-9">
                                        {{referenceFilter.form.endYear}}
                                    </div>
                                </div>
                                <button class="btn btn-outline-info btn-sm btn-block" type="submit">Search</button>
                            </form>
                        </div>
                    </div>


                    <div class="col-9">
                        <div class="card card-body">
                            <table class="table table-sm">
                                <tr>
                                    {% comment %}
                                    <th><a href=" {% url 'reference' reference.id %}">Title</a></th>
                                    {% endcomment %}
                                    <th>Title</th>
                                    <th>Rank</th>
                                    <th>Year</th>
                                    <th>ISBN</th>
                                    <th>DOI</th>
                                    <th>ISSN</th>
                                    <th>Team</th>
                                    <!--                                    <th>Update</th>-->
                                    <th>Delete</th>
                                </tr>

                                {% for reference in references %}

                                <tr>
                                    <td>{{reference.book_title}}</td>
                                    <td>{{reference.rank.code}}</td>
                                    <td>{{reference.year}}</td>
                                    <td>{{reference.isbn}}</td>
                                    <td>{{reference.doi}}</td>
                                    <td>{{reference.issn}}</td>
                                    <td>{{reference.team}}</td>
                                    {%if request.user in reference.authors.all or request.user.username == "kajza"%}
                                    <!--                                    <td><a class="btn btn-sm btn-info" href="">Update</a></td>-->
                                    <td><a class="btn btn-sm btn-danger"
                                           href="{% url 'delete_reference' reference.id %}">Remove</a></td>
                                    {%endif%}
                                </tr>
                                {% endfor %}

                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>


</body>


</html>